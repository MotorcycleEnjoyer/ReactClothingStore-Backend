<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Welcome to your Shopping Cart!</h1>

    <form action="/logout" method="POST"><button type="submit">Logout</button></form>

    <br>

    <button id="postData">POST DUMMY DATA TO SERVER</buttonj>
    <button id="fetchData">FETCH DATA</button>
    <ol id="data">

    </ol>

    <script>
        let dummyProduct = {
                id: 420,
                name: "fourTwenty",
                manufacturerOrBrand: "T-Shirt-CO",
                size: 5,
                ageCategory: "10-15",
                sexCategory: "M",
                typeOfClothing: "Sweater",
                colorOptions: ["red", "green", "orange", "pink"],
                imagePreviewURL: "a",
                variationIsInStock: [{color: "red", amountInStock: 10}, {color: "green", amountInStock: 3}, {color: "orange", amountInStock: 0}, {color:"pink", amountInStock:2}],
                weight: {grams: 150},
                dimensions: "LxWxH",
                price: 15.99,
                materials: {polyester: "5%", cotton: "95%"},
                amount: 1,
        }
        let params = {
            product: dummyProduct,
        }

        document.getElementById("fetchData").addEventListener("click", fetchData)
        document.getElementById("postData").addEventListener("click", sendData)

        async function sendData(){
            const options = {
                method: 'POST',
                // Failure to specify header = GG
                headers: { "content-type": "application/json"},
                body: JSON.stringify(params), 
            }
            let promise = await fetch( 'http://localhost:5000/cart', options )

            if(promise.ok){
                console.log("DATA POST IS OK")
                let json = await promise.json()
                console.log(json)
            }
        }

        async function fetchData(){
            let promise = await fetch("http://localhost:5000/data")

            if(promise.ok){
                console.log("Data fetching function is okay!")
                let json = await promise.json()
                console.log(json)
                /* let dataList = document.querySelector("#data")
                dataList.innerHTML = json.shoppingCart.items.
                                        map(item => `<li id="list-${item}">${item}</li>`).join("") */
            }else{
                alert(`HTTP Error: ${promise.status}`)
            }
            
        }
    </script>
</body>
</html>